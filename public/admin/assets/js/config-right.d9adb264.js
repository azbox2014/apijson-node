(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["config-right"],{"0a49":function(t,e,a){var n=a("9b43"),o=a("626a"),i=a("4bf8"),s=a("9def"),l=a("cd1c");t.exports=function(t,e){var a=1==t,r=2==t,c=3==t,u=4==t,f=6==t,d=5==t||f,p=e||l;return function(e,l,m){for(var b,h,g=i(e),v=o(g),y=n(l,m,3),k=s(v.length),w=0,x=a?p(e,k):r?p(e,0):void 0;k>w;w++)if((d||w in v)&&(b=v[w],h=y(b,w,g),t))if(a)x[w]=h;else if(h)switch(t){case 3:return!0;case 5:return b;case 6:return w;case 2:x.push(b)}else if(u)return!1;return f?-1:c||u?u:x}}},1169:function(t,e,a){var n=a("2d95");t.exports=Array.isArray||function(t){return"Array"==n(t)}},"20d6":function(t,e,a){"use strict";var n=a("5ca1"),o=a("0a49")(6),i="findIndex",s=!0;i in[]&&Array(1)[i]((function(){s=!1})),n(n.P+n.F*s,"Array",{findIndex:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")(i)},"293e":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"config-right-page"},[a("div",{staticClass:"btns"},[a("el-button",{attrs:{type:"default"},on:{click:t.handleBack}},[t._v("返回")])],1),a("h3",{staticClass:"page-title"},[t._v("配置"+t._s(t.$route.query.id?"编辑":"新增"))]),a("div",{staticClass:"content"},[a("el-form",{ref:"form",staticClass:"form",attrs:{"label-width":"200px"}},[a("el-form-item",{staticClass:"form-item",attrs:{label:"应用名"}},[a("el-input",{staticClass:"form-input",model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),a("el-form-item",{staticClass:"form-item",attrs:{label:"应用签名app-sign"}},[a("el-input",{staticClass:"form-input",model:{value:t.form.appSign,callback:function(e){t.$set(t.form,"appSign",e)},expression:"form.appSign"}})],1),a("el-form-item",{staticClass:"form-item",attrs:{label:"权限校验类型authType"}},[a("el-select",{staticClass:"form-input",model:{value:t.form.authType,callback:function(e){t.$set(t.form,"authType",e)},expression:"form.authType"}},t._l(t.authTypeOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),a("div",{staticClass:"hr"}),a("div",{staticClass:"btns"},[a("el-button",{attrs:{type:"primary"},on:{click:t.addTable}},[t._v("添加数据表")])],1),a("div",{staticClass:"tables-container"},t._l(t.tableList,(function(e){return a("div",{key:e.desc,staticClass:"table-config"},[a("div",{key:e.desc,staticClass:"table-title"},[t._v("\n          "+t._s(e.desc)+" < "+t._s(e.tableName)+" >\n          "),a("el-button",{staticStyle:{margin:"0 20px"},attrs:{type:"text"},on:{click:function(a){return t.delTable(e)}}},[t._v("删除")]),a("el-checkbox",{attrs:{label:"全选"},on:{change:function(a){return t.toggle(a,e)}}}),a("el-checkbox",{attrs:{label:"add"},model:{value:e.allowAdd,callback:function(a){t.$set(e,"allowAdd",a)},expression:"table.allowAdd"}}),a("el-checkbox",{attrs:{label:"delete"},model:{value:e.allowDel,callback:function(a){t.$set(e,"allowDel",a)},expression:"table.allowDel"}})],1),t._l(e.column,(function(e){return a("div",{key:e.key,staticClass:"field"},[a("div",{staticClass:"field-title"},[t._v(t._s(e.desc)+" "),a("br"),t._v("<"+t._s(e.key)+">")]),a("div",{staticClass:"field-auth"},[a("el-checkbox-group",{model:{value:e.methods,callback:function(a){t.$set(e,"methods",a)},expression:"column.methods"}},[a("el-checkbox",{attrs:{label:"get"}}),a("el-checkbox",{attrs:{label:"update"}})],1)],1)])}))],2)})),0),a("el-button",{attrs:{type:"primary"},on:{click:t.saveConfig}},[t._v("保存配置")]),a("el-dialog",{attrs:{title:"选择需要添加的表",visible:t.showDialog,"modal-append-to-body":!1,width:"500px"},on:{"update:visible":function(e){t.showDialog=e}}},[a("div",{staticClass:"dialog-content"},t._l(t.tables,(function(e){return a("div",{key:e.key,staticClass:"table-column",on:{click:function(a){return t.chooseToAddTable(e)}}},[t._v("\n          "+t._s(e.desc)+" "),a("br"),t._v(" <"+t._s(e.tableName)+">\n        ")])})),0),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.showDialog=!1}}},[t._v("关 闭")])],1)])],1)])},o=[],i=(a("8e6e"),a("ac6a"),a("456d"),a("7f7f"),a("bd86"));a("20d6");function s(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function l(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?s(a,!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):s(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var r={name:"config-right-page",data:function(){return{showDialog:!1,form:{name:"",authType:"uc"},authTypeOptions:[{value:"",label:"不校验"},{value:"uc",label:"uc"}],tables:[],tableList:[]}},mounted:function(){this.getTableList(),this.getConfigDetail()},methods:{toggle:function(t,e){var a=t?["update","get"]:[];e.column=e.column.map((function(t){return t.methods=a,t}))},delTable:function(t){var e=this;this.$confirm("是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.tableList=e.tableList.filter((function(e){return e.tableName!==t.tableName}))}))},chooseToAddTable:function(t){var e=this.tableList.findIndex((function(e){return e.tableName===t.tableName}));e>-1?this.$message({type:"error",message:"该表已存在"}):(this.tableList.splice(0,0,t),this.showDialog=!1)},saveConfig:function(){var t=this;console.log(this.tableList),this.$http({method:"POST",url:"/common/config/save",data:l({id:this.$route.query.id||0},this.form,{tableRight:JSON.stringify(this.tableList)})}).then((function(e){0===e.data.code?t.$message({type:"success",message:"保存成功"}):t.$message({type:"error",message:e.data.msg})}))},getConfigDetail:function(){var t=this,e=this.$route.query.id;e&&this.$http({method:"GET",url:"/common/config/detail",params:{id:e}}).then((function(e){if(0===e.data.code){t.form={name:e.data.data.name,appSign:e.data.data.appSign,authType:e.data.data.authType};try{var a=JSON.parse(e.data.data.tableRight);t.tableList=a}catch(n){console.error(n)}}}))},getTableList:function(){var t=this;this.$http({method:"GET",url:"/common/configs/getTables"}).then((function(e){0===e.data.code&&(t.tables=e.data.data.tables.map((function(t){return t.column=t.column.map((function(t){return t.methods=[],t})),t.allowAdd=!1,t.allowDel=!1,t})))}))},addTable:function(){this.showDialog=!0},handleBack:function(){this.$router.go(-1)}}},c=r,u=(a("de57"),a("2877")),f=Object(u["a"])(c,n,o,!1,null,"7c617099",null);e["default"]=f.exports},"7f7f":function(t,e,a){var n=a("86cc").f,o=Function.prototype,i=/^\s*function ([^ (]*)/,s="name";s in o||a("9e1e")&&n(o,s,{configurable:!0,get:function(){try{return(""+this).match(i)[1]}catch(t){return""}}})},cd1c:function(t,e,a){var n=a("e853");t.exports=function(t,e){return new(n(t))(e)}},de57:function(t,e,a){"use strict";var n=a("ee40"),o=a.n(n);o.a},e853:function(t,e,a){var n=a("d3f4"),o=a("1169"),i=a("2b4c")("species");t.exports=function(t){var e;return o(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!o(e.prototype)||(e=void 0),n(e)&&(e=e[i],null===e&&(e=void 0))),void 0===e?Array:e}},ee40:function(t,e,a){}}]);
//# sourceMappingURL=config-right.d9adb264.js.map