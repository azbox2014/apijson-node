(this["webpackJsonpadmin-v2"]=this["webpackJsonpadmin-v2"]||[]).push([[1],{388:function(e,t,a){e.exports=a(737)},393:function(e,t,a){},394:function(e,t,a){},395:function(e,t,a){},437:function(e,t,a){},454:function(e,t,a){},533:function(e,t,a){},534:function(e,t,a){},535:function(e,t,a){e.exports=a.p+"static/media/bg.8b5a8d0a.png"},717:function(e,t,a){},718:function(e,t,a){},719:function(e,t,a){},737:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(29),l=a.n(c),o=(a(393),a(294)),i=a(192),u=a(84),m=(a(394),a(24)),s=a(806),d=a(238),p=a(33),f=(a(395),a(813)),b=a(290),g=a(810),E=a(253),h=a(814),O=a(148),v=a(180);function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function y(e){var t=Object(n.useState)({}),a=Object(m.a)(t,2),r=a[0],c=a[1],l=Object(n.useState)(!1),o=Object(m.a)(l,2),i=o[0],u=o[1];return Object(n.useEffect)((function(){var t=!1;return _e.source=Ne.source(),t||u(!0),Pe(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(a,!0).forEach((function(t){Object(v.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e,{cancelToken:_e.source.token})).then((function(e){0===e.data.code?t||c(e.data.data):f.a.error(e.data.msg)})).finally((function(){t||u(!1)})).catch((function(e){console.error(e)})),function(){t=!0,_e.source.cancel&&_e.source.cancel("\u53d6\u6d88\u8bf7\u6c42"+e.url)}}),[e]),{data:r,setData:c,loading:i}}function k(e){var t=e.startsWith("?")?e.slice(1):e,a=decodeURIComponent(t).split("&").map((function(e){var t=e.split("=");return{key:t[0],value:t[1]}})),n={};return a.forEach((function(e){n[e.key]=e.value})),n}function S(e){var t="?";return Object.keys(e).forEach((function(a){t+="".concat(encodeURIComponent(a),"=").concat(encodeURIComponent(e[a]),"&")})),t.slice(0,-1)}a(437);var x=function(){var e=["http://192.168.94.186:9771","https://apijson.guahao.com"],t=Object(n.useState)(0),a=Object(m.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(e[0]),i=Object(m.a)(o,2),u=i[0],s=i[1],d=Object(n.useState)("/api/get"),p=Object(m.a)(d,2),v=p[0],j=p[1],k=Object(n.useState)(void 0),S=Object(m.a)(k,2),x=S[0],w=S[1],C=Object(n.useState)([]),I=Object(m.a)(C,2),N=I[0],_=(I[1],y(Object(n.useMemo)((function(){return{url:"/v2/common/app/list",params:{search:"",page:1,pageSize:1e4}}}),[]))),P=_.data,T=_.loading;Object(n.useEffect)((function(){s(e[c]+v+(x&&"?app-sign=".concat(x)||""))}),[c,v,x]);return r.a.createElement("div",{className:"body-gen-page"},r.a.createElement("div",{className:"config"},r.a.createElement("div",{className:"config-item"},r.a.createElement("span",{className:"label"},"\u73af\u5883\uff1a"),r.a.createElement(b.a.Group,{value:c,buttonStyle:"solid",onChange:function(e){var t=e.target;return l(t.value)}},r.a.createElement(b.a.Button,{value:0},"\u6d4b\u8bd5\u73af\u5883"),r.a.createElement(b.a.Button,{value:1},"\u6b63\u5f0f\u73af\u5883"))),r.a.createElement("div",{className:"config-item"},r.a.createElement("span",{className:"label"},"\u65b9\u6cd5\uff1a"),r.a.createElement(b.a.Group,{value:v,buttonStyle:"solid",onChange:function(e){var t=e.target;return j(t.value)}},r.a.createElement(b.a.Button,{value:"/api/get"},"\u67e5\u8be2"),r.a.createElement(b.a.Button,{value:"/api/update"},"\u66f4\u65b0"),r.a.createElement(b.a.Button,{value:"/api/delete"},"\u5220\u9664"),r.a.createElement(b.a.Button,{value:"/api/transaction"},"\u4e8b\u52a1"))),r.a.createElement("div",{className:"config-item"},r.a.createElement("span",{className:"label"},"\u8bf7\u6c42\u5730\u5740\uff1a"),r.a.createElement(g.a,{value:u,style:{width:500}})),r.a.createElement("div",{className:"config-item"},r.a.createElement("span",{className:"label"},"\u5e94\u7528\uff1a"),r.a.createElement(E.a,{placeholder:"\u8bf7\u9009\u62e9\u5e94\u7528",showSearch:!0,onChange:w,value:x,style:{width:500}},P&&P.list&&P.list.map((function(e){return r.a.createElement(E.a.Option,{value:e.app_code,key:e.id},"".concat(e.name," <").concat(e.app_code,">"))}))))),r.a.createElement(h.a,{loading:T,paragraph:{rows:10},active:!0},r.a.createElement("div",{className:"content-wrap"},r.a.createElement("div",{className:"steps-content"},r.a.createElement("div",{className:"operations"},r.a.createElement(O.a,{style:{marginRight:10},onClick:function(){x||f.a.warning("\u8bf7\u5148\u9009\u62e9\u4e00\u4e2a\u5e94\u7528")}},"\u6dfb\u52a0\u5355\u6761\u6570\u636e\u4efb\u52a1"),r.a.createElement(O.a,{style:{marginRight:10},onClick:function(){x||f.a.warning("\u8bf7\u5148\u9009\u62e9\u4e00\u4e2a\u5e94\u7528")}},"\u6dfb\u52a0\u5217\u8868\u67e5\u8be2\u4efb\u52a1"),r.a.createElement(O.a,{style:{marginRight:10},onClick:function(){x?N.length||f.a.warning("\u7f3a\u5c11\u524d\u7f6e\u4efb\u52a1\uff0c\u8054\u8868\u4efb\u52a1\u9700\u8981\u524d\u7f6e\u4efb\u52a1"):f.a.warning("\u8bf7\u5148\u9009\u62e9\u4e00\u4e2a\u5e94\u7528")}},"\u6dfb\u52a0\u8054\u8868\u4efb\u52a1"))),r.a.createElement("div",{className:"json-scheme"}))))},w=(a(454),function(){return r.a.createElement("div",{className:"welcome-page"},r.a.createElement("div",{className:"title"},"APIJSON \u4f7f\u7528\u6587\u6863"),r.a.createElement("div",{className:"base-info"},r.a.createElement("span",null,"2020-02-10 \u6700\u65b0\u66f4\u65b0\u65f6\u95f4"),r.a.createElement("br",null),r.a.createElement("s",null,"2019-12-10")),r.a.createElement("div",{className:"paragraph"},r.a.createElement("h2",null,"APIJSON\u662f\u4ec0\u4e48\uff1f"),r.a.createElement("div",{className:"sp-line"}),r.a.createElement("p",null,"APIJSON\u662f\u4e00\u4e2a\u63a5\u53e3\u81ea\u52a8\u5316\u5de5\u5177\uff0c\u80fd\u6839\u636e\u914d\u7f6e\u7684\u8868\u7ed3\u6784\u81ea\u52a8\u5316\u751f\u6210CRUD\u63a5\u53e3"),r.a.createElement("div",{className:"gap"}),r.a.createElement("h2",null,"\u8bbe\u8ba1\u539f\u5219"),r.a.createElement("div",{className:"sp-line"}),r.a.createElement("p",null,"\u5728\u5de5\u4f5c\u4e2d\u6211\u4eec\u53d1\u73b0\uff0c\u5b58\u5728\u7740\u5927\u91cf\u91cd\u590d\u7684\u7b80\u5355CRUD\u63a5\u53e3\u7684\u7f16\u5199\u5de5\u4f5c\u3002\u4e3a\u4e86\u51cf\u5c11\u91cd\u590d\u52b3\u52a8\uff0cAPIJSON\u8bde\u751f\u4e86\u3002\u5b83\u96c6\u6210\u4e86\u5230",r.a.createElement("b",null,"\u5b57\u6bb5\u7ea7\u522b"),"\u7684\u589e\u5220\u6539\u67e5\u7684",r.a.createElement("b",null,"\u6743\u9650\u63a7\u5236"),"\uff0c",r.a.createElement("b",null,"\u53ef\u70ed\u63d2\u62d4\u7684\u4e2d\u95f4\u4ef6\u673a\u5236"),"\uff08\u76ee\u524d\u5b9e\u73b0\u4e86Request\u9636\u6bb5\uff0cResponse\u5728\u5f00\u53d1\u4e2d\uff09")),r.a.createElement("div",{className:"paragraph"},r.a.createElement("h2",null,"\u914d\u7f6e\u6307\u5357"),r.a.createElement("div",{className:"sp-line"}),r.a.createElement("p",null,"1.\u5982\u679c\u9700\u8981\u4f7f\u7528\u7684\u6570\u636e\u8868\u5728 ",r.a.createElement("i",null,"\u6743\u9650\u7ba1\u7406 > \u8868\u7ba1\u7406")," \u4e2d\u4e0d\u5b58\u5728\u6216\u6709\u66f4\u65b0\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u5f55\u5165\u3002"),r.a.createElement("p",null,"2.\u627e\u5230\u6570\u636e\u8868\uff0c",r.a.createElement("i",null,"\u914d\u7f6e\u8868\u6743\u9650\u89d2\u8272")),r.a.createElement("p",null,"3.\u5728 ",r.a.createElement("i",null,"\u89d2\u8272\u7ba1\u7406")," \u4e2d\u6dfb\u52a0\u5bf9\u5e94\u7684\u89d2\u8272"),r.a.createElement("p",null,"4.\u5728 ",r.a.createElement("i",null,"\u5e94\u7528\u7ba1\u7406")," \u4e2d\u65b0\u5efa\u5e94\u7528\uff0c\u5e76\u6dfb\u52a0\u9700\u8981\u4f7f\u7528\u7684\u89d2\u8272"),r.a.createElement("p",null,"5.\u5982\u9700\u6dfb\u52a0\u4e2d\u95f4\u4ef6\uff08\u5982UC\u6743\u9650\u6821\u9a8c\uff09, \u53ef\u5728\u5e94\u7528\u7ba1\u7406\u4e2d\u914d\u7f6e")),r.a.createElement("div",{className:"paragraph"},r.a.createElement("h2",null,"\u4e2d\u95f4\u4ef6\u7f16\u5199\u987b\u77e5"),r.a.createElement("div",{className:"sp-line"}),r.a.createElement("p",null,"\u4e2d\u95f4\u4ef6\u662f\u4ee5\u51fd\u6570\u7684\u5f62\u5f0f\u5b58\u5728\u7684\uff0c\u8fd9\u4e2a\u51fd\u6570\u5728\u8fd0\u884c\u65f6\u4f1a\u88ab\u6ce8\u5165\u56db\u4e2a\u53c2\u6570\uff0c\u5206\u522b\u662f",r.a.createElement("i",null,"req"),"\u3001 ",r.a.createElement("i",null,"res"),"\u3001 ",r.a.createElement("i",null,"next"),"\uff0c ",r.a.createElement("i",null,"tools"),"\uff0c \u5982\u679c\u4f7f\u7528\u8fc7Express\uff0c\u5e94\u8be5\u6bd4\u8f83\u719f\u6089req\u3001res\u548cnext\uff0c\u53ea\u4e0d\u8fc7\u8fd9\u91cc\u7684next\u5e76\u4e0d\u662fExpress\u4e2d\u7684next\uff0c\u800c\u662f\u6211\u5185\u90e8\u5b9e\u73b0\u7684\u4e00\u4e2a\u65b9\u6cd5\uff0c\u4f5c\u7528\u4e0eExpress\u4e2d\u7684next\u7c7b\u4f3c\uff0c\u7528\u4e8e\u5728\u903b\u8f91\u5904\u7406\u5b8c\u6210\u4e4b\u540e\u89e6\u53d1\u4e0b\u4e00\u4e2a\u4e2d\u95f4\u4ef6\uff0c\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u662f\uff0c\u8fd9\u4e2a\u51fd\u6570\u5fc5\u987b\u4fdd\u8bc1\u59cb\u7ec8\u80fd\u8c03\u7528\u5230next\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4\u8bf7\u6c42\u4e00\u76f4\u5904\u4e8e ",r.a.createElement("i",null,"pending")," \u72b6\u6001\u3002\u8fd9\u91cc\u6765\u4ecb\u7ecd\u4e00\u4e0btools\uff0c\u8fd9\u662f\u4e00\u4e2a\u5185\u7f6e\u7684\u5de5\u5177\u96c6\u5408\uff0c\u76ee\u524d\u5305\u62ec ",r.a.createElement("i",null,"Axios"),"\uff0c ",r.a.createElement("i",null,"sha1hex"),"\u3002\u5982\u9700\u5176\u4ed6\u5de5\u5177\u5305\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6dfb\u52a0\u3002")),r.a.createElement("div",{className:"paragraph"},r.a.createElement("h2",null,"\u5bf9\u5916\u63a5\u53e3\u8c03\u7528\u6307\u5357"),r.a.createElement("div",{className:"sp-line"}),r.a.createElement("p",null,"\u63a5\u53e3\u5747\u4e3aPOST\u8bf7\u6c42 ",r.a.createElement("i",null,"/api/transaction")," ",r.a.createElement("i",null,"/api/get")," ",r.a.createElement("i",null,"/api/update")," ",r.a.createElement("i",null,"/api/add")," ",r.a.createElement("i",null,"/api/delete")," "),r.a.createElement("div",{className:"sp-line"}),r.a.createElement("h2",null,"\u53c2\u6570\u4ecb\u7ecd"),r.a.createElement("div",{className:"desc"},"\u8bf4\u660e\uff1a\u53c2\u6570\u53ef\u653e\u5728\u8bf7\u6c42\u7684Header\u6216query\u4e2d"),r.a.createElement("p",null,r.a.createElement("i",null,"app-sign")," \u5fc5\u4f20\uff0c\u5373\u5e94\u7528\u7ba1\u7406\u4e2d\u914d\u7f6e\u7684appCode"),r.a.createElement("p",null,r.a.createElement("i",null,"wyy-tk")," \u53ef\u9009\uff0c\u7528\u4e8e\u5fae\u533b\u4e91\u767b\u5f55\u7684token\u6821\u9a8c")),r.a.createElement("div",{className:"paragraph"},r.a.createElement("h2",null,"\u64cd\u4f5c\u7b26\u4ecb\u7ecd"),r.a.createElement("div",{className:"sp-line"}),r.a.createElement("div",{className:"desc"},"\u5168\u5c40\u64cd\u4f5c\u7b26"),r.a.createElement("p",null,r.a.createElement("b",null,"\u5217\u8868\u64cd\u4f5c\u7b26 []")," (e.g.  list[]) \u7528\u4e8e\u6307\u5b9a\u5728\u8be5\u5bf9\u8c61\u4e0b\u7684\u64cd\u4f5c\u4e3a\u5217\u64cd\u4f5c\uff0c\u5e76\u6307\u5b9a\u8be5\u5217\u8868\u96c6\u5408\u7684key\u4e3a [] \u524d\u4f20\u5165\u7684\u90e8\u5206\uff0c\u5982\u4f8b\u5b50\u4e2d\u5373list\u3002"),r.a.createElement("p",null,r.a.createElement("b",null,"\u522b\u540d\u64cd\u4f5c\u7b26 #")," (e.g. alias#) \u7528\u4e8e\u5d4c\u5957\u6307\u5b9a\u8be5\u5bf9\u8c61\u7684key\u503c\u3002"),r.a.createElement("div",{className:"sp-line"}),r.a.createElement("div",{className:"desc"},"\u5b57\u6bb5\u64cd\u4f5c\u7b26\uff08\u53ea\u53ef\u7528\u4e8e\u5b57\u6bb5\u540d\uff09"),r.a.createElement("p",null,r.a.createElement("b",null,"\u65f6\u95f4\u8303\u56f4\u64cd\u4f5c\u7b26 %"),' (e.g.  "created_at%": "2018-1-1,2018-2-1") \u7528\u4e8e\u6307\u5b9a\u65f6\u95f4\u8303\u56f4\uff0c\u5728\u5b57\u6bb5\u540d\u540e\u52a0%\uff0c\u503c\u4e3a\u5408\u6cd5\u7684\u4e24\u4e2a\u65f6\u95f4\u6bb5\u5b57\u7b26\u4e32\uff0c\u7528 , \u8fde\u63a5\uff0c\u5408\u6cd5\u7684\u5224\u65ad\u6807\u51c6\u662f \u80fd\u88ab Date.parse \u89e3\u6790\u3002\u53e6\u5916\uff0c\u63d0\u4f9b\u4e86\u534a\u5f00\u8303\u56f4\u7684\u8f93\u5165\uff0ce.g.   2018-1-1,  \u8868\u793a\u4ece2018\u5e741\u67081\u53f7\u81f3\u4eca\uff0c\u540c\u7406  ,2018-1-1  \u8868\u793a2018\u5e741\u67081\u65e5\u4e4b\u524d\u3002'),r.a.createElement("p",null,r.a.createElement("b",null,"\u6216\u64cd\u4f5c\u7b26 |"),' (e.g. "id|": "1,2,3") \u7528\u4e8e\u5728\u5217\u8868\u64cd\u4f5c\u4e2d\u4e00\u6b21\u6027\u53d6\u51fa\u591a\u4e2a\u5305\u542b\u6240\u7ed9\u503c\u7684\u6570\u636e\u3002'),r.a.createElement("p",null,r.a.createElement("b",null,"\u6a21\u7cca\u5339\u914d\u64cd\u4f5c\u7b26 ~"),' (e.g. "name~": "\u5c0f\u738b") \u7528\u4e8e\u5728\u5217\u8868\u64cd\u4f5c\u4e2d\u6a21\u7cca\u5339\u914d\u5b57\u6bb5\u3002\u5982\u679c\u8981\u5339\u914d\u4ee5 \u5c0f\u738b \u7ed3\u5c3e\u7684\uff0c\u53ef\u4f20\u5165 %\u5c0f\u738b, \u540c\u7406\uff0c\u5c0f\u738b\u5f00\u5934\u7684\u4e3a \u5c0f\u738b%, \u5982\u76f4\u63a5\u4f20\u5c0f\u738b\uff0c\u5b9e\u9645\u4f1a\u8f6c\u5316\u4e3a %\u5c0f\u738b% \uff0c\u524d\u540e\u90fd\u5339\u914d\u3002'),r.a.createElement("p",null,r.a.createElement("b",null,"\u8fde\u8868\u67e5\u8be2\u64cd\u4f5c\u7b26 @"),' (e.g. "id@": "alias#/User/userId") \u7528\u4e8e\u6307\u5b9a\u5339\u914d\u5176\u4ed6\u8868\u4e2d\u5b57\u6bb5\uff0c\u4f8b\u5b50\u4e2d\u8868\u793a\u7684\u662fid\u5173\u8054alias#\u4e0b\u7684User\u8868\u4e2d\u7684userId'),r.a.createElement("p",null,r.a.createElement("b",null,"\u6279\u91cf\u66f4\u65b0\u64cd\u4f5c\u7b26 *"),' (e.g. "is_deleted*": "1") \u7528\u4e8eupdate\u64cd\u4f5c\u5217\u8868\u65f6\uff0c\u6279\u91cf\u66f4\u65b0\u6240\u6709\u7684\u88ab\u6307\u5b9a\u5b57\u6bb5')),r.a.createElement("div",{className:"paragraph"},r.a.createElement("h2",null,"\u4e8b\u52a1\u4ecb\u7ecd"),r.a.createElement("div",{className:"sp-line"}),r.a.createElement("div",{className:"desc"},"\u8bf7\u6c42\u7ed3\u6784"),r.a.createElement("pre",null,JSON.stringify([{User:{name:"kiki"},action:"add"},{Comment:{"userId`":"${data.res1.id}",content:"test"},action:"add"},{User:{name:"yy"},action:"add"},{Comment:{"userId`":"${data.res3.id}",content:"test1"},action:"add"}],null,4)),r.a.createElement("p",null,"\u7528\u6570\u7ec4\u6309\u987a\u5e8f\u5305\u88f9\u9700\u8981\u6267\u884c\u7684\u4efb\u52a1"),r.a.createElement("p",null,r.a.createElement("b",null,"action (\u5fc5\u4f20)")," \u53d6\u503c ",r.a.createElement("i",null,"add")," ",r.a.createElement("i",null,"delete")," ",r.a.createElement("i",null,"update")),r.a.createElement("p",null,r.a.createElement("b",null,"\u53ef\u7528\u5b57\u7b26\u4e32\u6a21\u677f\u7684\u8bed\u6cd5\u6765\u83b7\u53d6\u524d\u9762\u4efb\u52a1\u4e2d\u751f\u6210\u7684id")," \u4ee5 ",r.a.createElement("i",null,"`")," \u7ed3\u5c3e\u7684\u952e \u5bf9\u5e94\u7684\u503c\u4f1a\u88ab\u89e3\u6790\u6210\u5b57\u7b26\u4e32\u6a21\u677f\uff0c\u53d6\u503c\u89c4\u5219\u662f data.res1.id \u5176\u4e2d1\u4e3a\u4efb\u52a1\u5e8f\u53f7\uff0c\u4ece\u524d\u5230\u540e\uff0c\u4ece1\u9012\u589e")))}),C=a(807),I=a(383),N=a(384),_=a(805),P=C.a.Column,T=g.a.Search,q=function(){var e=Object(i.g)(),t=Object(n.useState)(""),a=Object(m.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(1),s=Object(m.a)(o,2),d=s[0],p=s[1],f=Object(n.useState)(10),b=Object(m.a)(f,2),g=b[0],E=b[1],h=y(Object(n.useMemo)((function(){return{url:"/v2/common/app/list",params:{search:c,page:c?1:d,pageSize:8}}}),[d,c])),v=h.data,j=h.loading;Object(n.useEffect)((function(){E(v.totalCount)}),[v]);var k={showTotal:function(){return"\u5171".concat(g,"\u6761")},pageSize:8,current:d,total:g,onChange:function(e){return p(e)}};return r.a.createElement(r.a.Fragment,null,r.a.createElement(T,{placeholder:"\u641c\u7d22\u5e94\u7528",onSearch:function(e){return l(e)},style:{width:200,marginBottom:30}}),r.a.createElement(O.a,{type:"primary",style:{float:"right"},onClick:function(){e.push("/home/add-or-edit-app")}},"\u65b0\u589e\u5e94\u7528"),r.a.createElement(C.a,{dataSource:v.list,loading:j,rowKey:"id",pagination:k},r.a.createElement(P,{title:"\u5e94\u7528\u540d",width:200,dataIndex:"name",key:"name"}),r.a.createElement(P,{title:"\u5e94\u7528code",width:150,dataIndex:"app_code",key:"app_code"}),r.a.createElement(P,{title:"Req\u4e2d\u95f4\u4ef6",dataIndex:"req_middleware_list",render:function(e){return e.length?e.map((function(e){return r.a.createElement(I.a,{title:(1===e.checked?"[\u5ba1\u6838\u901a\u8fc7]":"[\u672a\u5ba1\u6838]")+e.desc,key:e.id},r.a.createElement(N.a,{color:1===e.checked?"green":"red",key:e.id},e.name))})):r.a.createElement(N.a,{color:"red"},"\u65e0")}}),r.a.createElement(P,{width:200,title:"\u64cd\u4f5c",render:function(t){return r.a.createElement("span",null,r.a.createElement(O.a,{type:"link",onClick:function(){return function(t){e.push("/home/add-or-edit-app".concat(S({id:t.id,name:t.name})))}(t)}},"\u7f16\u8f91"),r.a.createElement(_.a,{type:"vertical"}),r.a.createElement(u.b,{to:"/home",style:{color:"red"}},"\u5220\u9664"))}})))},B=a(72),R=a.n(B),D=a(114),U=a(811),K=(a(533),C.a.Column),L=g.a.Search,F=function(){var e=Number(sessionStorage.getItem("table-manage-page")||"1"),t=Object(n.useState)(""),a=Object(m.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(e),i=Object(m.a)(o,2),s=i[0],d=i[1],p=Object(n.useState)(10),b=Object(m.a)(p,2),E=b[0],h=b[1],v=Object(n.useState)(!1),j=Object(m.a)(v,2),k=j[0],x=j[1],w=Object(n.useState)(!1),I=Object(m.a)(w,2),_=(I[0],I[1],Object(n.useState)(0)),P=Object(m.a)(_,2),T=P[0],q=P[1],B=Object(n.useState)(""),F=Object(m.a)(B,2),z=F[0],M=F[1],A=Object(n.useState)(""),J=Object(m.a)(A,2),$=J[0],G=J[1],Y=Object(n.useState)(""),Z=Object(m.a)(Y,2),H=Z[0],W=Z[1],Q=Object(n.useState)(""),V=Object(m.a)(Q,2),X=V[0],ee=V[1],te=Object(n.useState)(""),ae=Object(m.a)(te,2),ne=ae[0],re=ae[1],ce=Object(n.useState)("id"),le=Object(m.a)(ce,2),oe=le[0],ie=le[1],ue=Object(n.useState)(""),me=Object(m.a)(ue,2),se=me[0],de=me[1],pe=Object(n.useState)(""),fe=Object(m.a)(pe,2),be=(fe[0],fe[1],Object(n.useState)(1)),ge=Object(m.a)(be,2),Ee=ge[0],he=ge[1],Oe=y(Object(n.useMemo)((function(){return{url:"/v2/common/tables",params:{search:c,page:c?1:s,pageSize:10}}}),[s,c,Ee])),ve=Oe.data,je=Oe.loading;Object(n.useEffect)((function(){h(ve.totalCount)}),[ve]);var ye={showTotal:function(){return"\u5171".concat(E,"\u6761")},pageSize:10,current:s,total:E,onChange:function(e){d(e),sessionStorage.setItem("table-manage-page",String(e))}},ke=function(){var e=Object(D.a)(R.a.mark((function e(){var t;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(H){e.next=3;break}return f.a.error("\u8bf7\u8f93\u5165\u5168\u5c40\u552f\u4e00\u8868\u540d"),e.abrupt("return");case 3:if(/^[a-zA-Z-_0-9]+$/.test(H)){e.next=6;break}return f.a.error("\u5168\u5c40\u552f\u4e00\u8868\u540d\u4e0d\u5408\u6cd5, \u5408\u6cd5\u7684\u540d\u5b57\u4e3a[a-zA-Z0-9-_]"),e.abrupt("return");case 6:if(z){e.next=9;break}return f.a.error("\u8bf7\u8f93\u5165\u6570\u636e\u5e93\u540d\u79f0(\u5982\u672a\u5f55\u5165\uff0c\u8bf7\u5148\u5f55\u5165\u6570\u636e\u5e93\u4fe1\u606f)"),e.abrupt("return");case 9:return e.next=11,Pe({url:"/v2/common/table/update",method:"POST",data:{id:T,db:z,dbTable:H,dbNick:$,sql:se,uniqueKey:oe,uuid:ne}});case 11:0===(t=e.sent).data.code?(f.a.success(t.data.msg),x(!1),he(Ee+1)):f.a.error(t.data.msg);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Se=function(){var e=Object(D.a)(R.a.mark((function e(){var t;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pe({url:"/v2/common/apply/table/config",method:"POST"});case 2:0===(t=e.sent).data.code?(f.a.success("\u5e94\u7528\u6210\u529f,\u5982\u9700\u751f\u6548\u914d\u7f6e\u9700\u8981\u3010\u70ed\u91cd\u542f\u3011"),he(Ee+1)):f.a.error(t.data.msg);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),xe=function(){var e=Object(D.a)(R.a.mark((function e(){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:U.a.confirm({title:"\u786e\u8ba4\u91cd\u542f\u5417?",onOk:function(){var e=Object(D.a)(R.a.mark((function e(){var t;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pe({url:"/v2/common/rebuild",method:"POST"});case 2:0===e.sent.data.code&&(f.a.success("\u6b63\u5728\u91cd\u542f"),t=setInterval(Object(D.a)(R.a.mark((function e(){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pe({url:"/test",method:"GET"});case 2:"ok"===e.sent.data?(clearInterval(t),f.a.info("\u91cd\u542f\u5b8c\u6bd5\uff01"),he(Ee+1)):f.a.info("\u6b63\u5728\u98de\u901f\u91cd\u542f\u4e2d\uff01...");case 4:case"end":return e.stop()}}),e)}))),3e3));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),okText:"\u7acb\u5373\u91cd\u542f",cancelText:"\u518d\u7b49\u7b49\u5427"});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(L,{placeholder:"\u641c\u7d22\u6570\u636e\u8868",onSearch:l,style:{width:200,marginBottom:30,marginRight:30}}),r.a.createElement(O.a,{type:"ghost",style:{float:"right",marginRight:15},onClick:Se},"\u90e8\u7f72\u6240\u6709\u8868\u914d\u7f6e"),r.a.createElement(O.a,{type:"danger",style:{float:"right",marginRight:15},onClick:xe},"\u70ed\u91cd\u542f"),r.a.createElement(C.a,{dataSource:ve.list,loading:je,rowKey:"id",pagination:ye},r.a.createElement(K,{title:"\u6570\u636e\u8868\u540d\u79f0",dataIndex:"name",key:"name"}),r.a.createElement(K,{title:"table",dataIndex:"filename",key:"filename"}),r.a.createElement(K,{title:"UUID",dataIndex:"uuid",key:"uuid",render:function(e){return e?r.a.createElement("span",null,e):r.a.createElement("span",null,"\u672a\u8bbe\u7f6eUUID")}}),r.a.createElement(K,{title:"\u552f\u4e00\u4e0d\u91cd\u590dKey",dataIndex:"unique_key",key:"unique_key",render:function(e){return e?r.a.createElement("span",null,e):r.a.createElement("span",null,"\u672a\u8bbe\u7f6e")}}),r.a.createElement(K,{title:"\u72b6\u6001",dataIndex:"status",key:"status",render:function(e){return r.a.createElement(N.a,{color:0===e?"red":"green"},0===e?"\u672a":"\u5df2","\u751f\u6548")}}),r.a.createElement(K,{title:"\u64cd\u4f5c",key:"action",render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,r.a.createElement(u.b,{to:{pathname:"/home/table-manage/single-table-right-list",search:S({id:e.id,name:e.filename,desc:e.name})}},"\u914d\u7f6e\u8868\u6743\u9650\u89d2\u8272")),r.a.createElement(O.a,{type:"link",onClick:function(){return function(e){x(!0),q(e.id),M(e.db),G(e.name),W(e.filename),ie(e.unique_key),re(e.uuid),de(e.sql),ee(e.table_name)}(e)}},"\u7f16\u8f91"))}})),r.a.createElement(U.a,{width:800,title:"\u8bf7\u8f93\u5165\u5efa\u8868SQL",visible:k,onOk:ke,onCancel:function(){x(!1)},okText:"\u4fdd\u5b58",cancelText:"\u53d6\u6d88"},r.a.createElement("div",{style:{width:600}},r.a.createElement("div",{style:{display:"flex",alignItems:"center",marginBottom:15}},r.a.createElement("div",{style:{width:300,marginRight:15}},"\u6570\u636e\u5e93\u7d22\u5f15Key:"),r.a.createElement(g.a,{disabled:!0,placeholder:"\u6570\u636e\u5e93\u7ba1\u7406\u4e2d\u7684Key",onChange:function(e){var t=e.target;return M(t.value)},value:z})),r.a.createElement("div",{style:{display:"flex",alignItems:"center",marginBottom:15}},r.a.createElement("div",{style:{width:300,marginRight:15}},"\u6570\u636e\u5e93\u8868\u540d:"),r.a.createElement(g.a,{disabled:!0,placeholder:"\u771f\u5b9e\u8868\u540d",onChange:function(e){var t=e.target;return ee(t.value)},value:X})),r.a.createElement("div",{style:{display:"flex",alignItems:"center",marginBottom:15}},r.a.createElement("div",{style:{width:300,marginRight:15}},"\u5168\u5c40\u552f\u4e00\u8868\u540d(\u7528\u4e8e\u8c03\u7528):"),r.a.createElement(g.a,{placeholder:"\u5efa\u8bae\uff1a\u9a7c\u5cf0\u62fc\u63a5 \u4e1a\u52a1\u540d+\u6570\u636e\u5e93\u540d+\u8868\u540d",onChange:function(e){var t=e.target;return W(t.value)},value:H})),r.a.createElement("div",{style:{display:"flex",alignItems:"center",marginBottom:15}},r.a.createElement("div",{style:{width:300,marginRight:15}},"\u6570\u636e\u8868\u4e2d\u6587\u540d:"),r.a.createElement(g.a,{placeholder:"\u6570\u636e\u8868\u4e2d\u6587\u540d",onChange:function(e){var t=e.target;return G(t.value)},value:$})),r.a.createElement("div",{style:{display:"flex",alignItems:"center",marginBottom:15}},r.a.createElement("div",{style:{width:300,marginRight:15}},"\u552f\u4e00\u4e0d\u91cd\u590dKey:"),r.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u552f\u4e00\u4e0d\u91cd\u590dKey(\u4e00\u822c\u4e3aprimaryKey)",onChange:function(e){var t=e.target;return ie(t.value)},value:oe})),r.a.createElement("div",{style:{display:"flex",alignItems:"center",marginBottom:15}},r.a.createElement("div",{style:{width:300,marginRight:15}},"Uuid:"),r.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165Uuid(\u53ef\u4e0d\u586b)",onChange:function(e){var t=e.target;return re(t.value)},value:ne})))))},z=C.a.Column,M=g.a.Search,A=function(){var e=Object(i.g)(),t=Number(sessionStorage.getItem("role-manage-page")||"1"),a=Object(n.useState)(""),c=Object(m.a)(a,2),l=c[0],o=c[1],s=Object(n.useState)(t),d=Object(m.a)(s,2),p=d[0],f=d[1],b=Object(n.useState)(10),g=Object(m.a)(b,2),E=g[0],h=g[1],v=y(Object(n.useMemo)((function(){return{url:"/v2/common/roles/list",params:{search:l,page:l?1:p,pageSize:10}}}),[p,l])),j=v.data,k=v.loading;Object(n.useEffect)((function(){h(j.totalCount)}),[j]);var x={showTotal:function(){return"\u5171".concat(E,"\u6761")},pageSize:10,current:p,total:E,onChange:function(e){f(e),sessionStorage.setItem("role-manage-page",String(e))}};return r.a.createElement(r.a.Fragment,null,r.a.createElement(M,{placeholder:"\u641c\u7d22\u89d2\u8272",onSearch:function(e){return o(e)},style:{width:200,marginBottom:30}}),r.a.createElement(O.a,{type:"primary",style:{float:"right"},onClick:function(){e.push("".concat("/home/role-detail").concat(S({})))}},"\u6dfb\u52a0\u89d2\u8272"),r.a.createElement(C.a,{dataSource:j.list,loading:k,rowKey:"id",pagination:x},r.a.createElement(z,{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"name",key:"name"}),r.a.createElement(z,{title:"\u89d2\u8272\u63cf\u8ff0",dataIndex:"desc",key:"desc"}),r.a.createElement(z,{title:"\u5305\u542b\u8868\u89d2\u8272",dataIndex:"table_right_list",key:"table_right_list"}),r.a.createElement(z,{title:"\u64cd\u4f5c",key:"action",render:function(e){return r.a.createElement("span",null,r.a.createElement(u.b,{to:{pathname:"/home/role-detail",search:S({id:e.id,name:e.name})}},"\u7f16\u8f91"))}})))},J=C.a.Column,$=g.a.Search,G=function(){var e=Object(i.g)(),t=Object(n.useState)(""),a=Object(m.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(1),s=Object(m.a)(o,2),d=s[0],p=s[1],b=Object(n.useState)(0),g=Object(m.a)(b,2),E=g[0],h=g[1],v=Object(n.useState)(10),j=Object(m.a)(v,2),k=j[0],x=j[1],w=y(Object(n.useMemo)((function(){return console.log("Refresh: ",E),{url:"/v2/common/customMid/list",params:{search:c,page:c?1:d,pageSize:10}}}),[d,c,E])),I=w.data,_=w.loading;Object(n.useEffect)((function(){x(I.totalCount)}),[I]);var P={showTotal:function(){return"\u5171".concat(k,"\u6761")},pageSize:10,current:d,total:k,onChange:function(e){return p(e)}},T=function(e,t){Pe({url:"/v2/common/customMid/checked",method:"POST",data:{id:t,checked:e}}).then((function(t){0===t.data.code?(f.a.success("".concat(0===e?"\u64a4\u56de":"\u5ba1\u6838","\u6210\u529f")),h(E+1)):f.a.error(t.data.msg)}))};return r.a.createElement(r.a.Fragment,null,r.a.createElement($,{placeholder:"\u641c\u7d22\u81ea\u5b9a\u4e49\u903b\u8f91",onSearch:function(e){return l(e)},style:{width:200,marginBottom:30}}),r.a.createElement(O.a,{type:"primary",style:{float:"right"},onClick:function(){e.push("".concat("/home/add-or-edit-mid").concat(S({})))}},"\u6dfb\u52a0\u81ea\u5b9a\u4e49\u903b\u8f91"),r.a.createElement(C.a,{dataSource:I.list,loading:_,rowKey:"id",pagination:P},r.a.createElement(J,{title:"\u81ea\u5b9a\u4e49\u903b\u8f91\u540d\u79f0",dataIndex:"name",key:"name",width:"200px"}),r.a.createElement(J,{title:"\u63cf\u8ff0",dataIndex:"desc",key:"desc",width:"200px"}),r.a.createElement(J,{title:"\u7c7b\u578b",width:"150px",render:function(e){return r.a.createElement(N.a,{color:"req"===e.type?"green":"blue"},"req"===e.type?"Request":"Response","\u4e2d\u95f4\u4ef6")}}),r.a.createElement(J,{title:"\u5ba1\u6838\u72b6\u6001",width:"150px",render:function(e){return r.a.createElement(N.a,{color:e.checked?"#87d068":"#f50"},e.checked?"\u901a\u8fc7":"\u672a\u5ba1\u6838")}}),r.a.createElement(J,{title:"\u64cd\u4f5c",key:"action",width:"200px",render:function(e){return r.a.createElement("span",null,r.a.createElement(u.b,{to:{pathname:"/home/add-or-edit-mid",search:S({id:e.id,name:e.name})}},"\u7f16\u8f91"),e.checked?r.a.createElement(O.a,{type:"link",style:{padding:"0 10px"},onClick:function(){return T(0,e.id)}},"\u64a4\u56de"):r.a.createElement(O.a,{type:"link",style:{padding:"0 10px"},onClick:function(){return T(1,e.id)}},"\u5ba1\u6838"))}})))},Y=a(377),Z=a(808),H=(a(534),function(){var e=Object(n.useState)(),t=Object(m.a)(e,2),c=t[0],l=t[1],o=Object(n.useState)(),i=Object(m.a)(o,2),u=i[0],s=i[1],d=Object(n.useState)(0),p=Object(m.a)(d,2),f=p[0],b=p[1],g=Object(n.useState)(0),E=Object(m.a)(g,2),h=E[0],O=E[1],v=Object(n.useState)(""),j=Object(m.a)(v,2),k=j[0],S=j[1],x=Object(n.useState)(),w=Object(m.a)(x,2),C=w[0],I=w[1];Object(n.useEffect)((function(){var e=new Y.Chart({container:"c1",height:500,width:960,autoFit:!1});s(e)}),[]);var N=y(Object(n.useMemo)((function(){return{url:"/v2/common/graphData",params:{startTime:k}}}),[k])),_=N.data;N.loading;return Object(n.useEffect)((function(){_&&_.rangeData&&_.rangeData.length&&l(_.rangeData),_&&_.sum&&(b(_.sum),O(_.lastTime),I(_.countGroupByApp))}),[_]),Object(n.useEffect)((function(){u?c&&!c.length||(u.data(c),u.scale("count",{nice:!0}),u.tooltip({showMarkers:!1,shared:!0}),u.interval().position("date*count").color("name").adjust([{type:"dodge",marginRatio:0}]),u.interaction("active-region"),u.render(),console.log("render")):console.log("chart not found")}),[c,u]),r.a.createElement("div",{className:"chart-container"},r.a.createElement("div",{className:"chart-cards"},r.a.createElement("div",{className:"sum-card",style:{backgroundImage:"url(".concat(a(535),")")}},r.a.createElement("p",null,"\u8c03\u7528\u6b21\u6570\uff1a",r.a.createElement("b",null,f)),r.a.createElement("p",null,"\u7edf\u8ba1\u5f00\u59cb\u65f6\u95f4\uff1a",r.a.createElement("b",null,h)))),r.a.createElement("div",{className:"group-count-card"},C&&Object.keys(C).map((function(e){return r.a.createElement("p",{key:e},"[",e,"]: ",r.a.createElement("b",null,C[e]))}))),r.a.createElement("h1",{className:"chart-title"},"\u63a5\u53e3\u8c03\u7528\u7edf\u8ba1\u56fe"),r.a.createElement("div",{className:"select-timer"},r.a.createElement("span",null,"\u9009\u62e9\u5f00\u59cb\u65f6\u95f4\uff08\u7edf\u8ba1\u5f00\u59cb\u65f6\u95f4\u81f3\u524d7\u65e5\u6570\u636e\uff09"),r.a.createElement(Z.a,{onChange:function(e,t){console.log(t),S(t)}})),r.a.createElement("div",{id:"c1"}))}),W=a(812);function Q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function V(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Q(a,!0).forEach((function(t){Object(v.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Q(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var X=C.a.Column,ee=function(){var e=Object(i.h)(),t=Object(i.g)(),a=k(e.search),c=a.desc||"",l=(a.name,a.id||""),s=Object(n.useState)(1),d=Object(m.a)(s,2),p=d[0],f=d[1],b=Object(n.useState)(10),g=Object(m.a)(b,2),E=g[0],h=g[1],v=y(Object(n.useMemo)((function(){return{url:"/v2/common/tableRight/list",params:{tableId:l,page:p,pageSize:10}}}),[p,l])),j=v.data,x=v.loading;Object(n.useEffect)((function(){c&&l||t.push("/home/table-manage"),j&&h(j.totalCount)}),[j,c,t,l]);var w={showTotal:function(){return"\u5171".concat(E,"\u6761")},pageSize:10,current:p,total:E,onChange:function(e){return f(e)}};return r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{style:{marginBottom:30},onBack:function(){t.goBack()},title:c,subTitle:"\u5728\u672c\u9875\u53ef\u4ee5\u8bbe\u7f6e\u8be5\u8868\u7684\u89d2\u8272\u6743\u9650",extra:r.a.createElement(O.a,{type:"primary",onClick:function(){var e=a.id,n=Object(o.a)(a,["id"]);t.push("".concat("/home/table-manage/add-or-edit-table-right").concat(S(V({tableId:e},n))))}},"\u6dfb\u52a0\u89d2\u8272")}),r.a.createElement(C.a,{dataSource:j.list,loading:x,rowKey:"id",pagination:w},r.a.createElement(X,{title:"\u8868\u89d2\u8272\u540d\u79f0",dataIndex:"name",key:"name"}),r.a.createElement(X,{title:"\u8868\u89d2\u8272\u63cf\u8ff0",dataIndex:"desc",key:"desc"}),r.a.createElement(X,{title:"\u53ef\u67e5\u8be2\u5b57\u6bb5",dataIndex:"get_fields",width:"25%",key:"get_fields",render:function(e){return e.split(",").map((function(e){return r.a.createElement(N.a,{key:e},e)}))}}),r.a.createElement(X,{title:"\u53ef\u66f4\u65b0\u5b57\u6bb5",dataIndex:"update_fields",width:"25%",key:"update_fields",render:function(e){return e.split(",").map((function(e){return r.a.createElement(N.a,{key:e},e)}))}}),r.a.createElement(X,{title:"\u80fd\u5426\u6dfb\u52a0\u6570\u636e",dataIndex:"add_right",key:"add_right",render:function(e){return r.a.createElement("span",null,e?"\u662f":"\u5426")}}),r.a.createElement(X,{title:"\u80fd\u5426\u5220\u9664\u6570\u636e",dataIndex:"del_right",key:"del_right",render:function(e){return r.a.createElement("span",null,e?"\u662f":"\u5426")}}),r.a.createElement(X,{title:"\u64cd\u4f5c",key:"action",render:function(e){return r.a.createElement("span",null,r.a.createElement(u.b,{to:{pathname:"/home/table-manage/add-or-edit-table-right",search:S(V({},a,{id:e.id}))}},"\u7f16\u8f91\u89d2\u8272"))}})))},te=a(239),ae=a(809),ne=a(232);function re(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var ce=C.a.Column,le=function(){var e=Object(i.g)(),t=k(Object(i.h)().search),a=t.name||"",c=t.id&&Number(t.id)||0,l=c>0?"\u7f16\u8f91 ".concat(t.desc," \u89d2\u8272"):"\u6dfb\u52a0 ".concat(t.desc," \u89d2\u8272"),o=Object(n.useState)(t.tableId&&Number(t.tableId)||0),u=Object(m.a)(o,2),s=u[0],d=u[1],p=Object(n.useState)(""),b=Object(m.a)(p,2),E=b[0],j=b[1],S=Object(n.useState)(""),x=Object(m.a)(S,2),w=x[0],I=x[1],N=Object(n.useState)(!1),_=Object(m.a)(N,2),P=_[0],T=_[1],q=Object(n.useState)(!1),B=Object(m.a)(q,2),R=B[0],D=B[1],U=Object(n.useState)([]),K=Object(m.a)(U,2),L=K[0],F=K[1],z=Object(n.useState)([]),M=Object(m.a)(z,2),A=M[0],J=M[1],$=Object(n.useState)(!1),G=Object(m.a)($,2),Y=G[0],Z=G[1];Object(n.useEffect)((function(){a||e.push("/home/table-manage")}),[a,e]);var H=y(Object(n.useMemo)((function(){return{url:"/v2/common/table",params:{name:a}}}),[a])),Q=H.data,V=H.loading;Object(n.useEffect)((function(){c&&(Z(!0),Pe({url:"/v2/common/tableRoleRight",params:{id:c}}).then((function(e){if(0===e.data.code){var t=e.data.data;d(Number(t.table)),j(t.name),I(t.desc),T(1===t.add_right),D(1===t.del_right),F(t.get_fields.split(",")),J(t.update_fields.split(","))}})).catch((function(e){f.a.error(e.message)})).finally((function(){return Z(!1)})))}),[c]);var X={wrapperCol:{xs:{span:16,offset:0},sm:{span:8,offset:8}}},ee=Q&&Q.columns||[],le=ee.map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?re(a,!0).forEach((function(t){Object(v.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):re(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({get:L.indexOf(e.key)>-1,update:A.indexOf(e.key)>-1},e)})),oe=function(e,t,a){var n=t.key,r="get"===e?F:J,c="get"===e?L:A;a?r([].concat(Object(te.a)(c),[n])):r(c.filter((function(e){return e!==n})))},ie=function(e,t){var a="get"===e?F:J;a(t?ee.map((function(e){return e.key})):[])};return r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{title:l,onBack:function(){e.goBack()},extra:r.a.createElement(O.a,{type:"primary",onClick:function(){E&&w?Pe({url:"/v2/common/saveTableRight",method:"POST",data:{id:c,name:E,table:s,desc:w,get_fields:L.filter((function(e){return!!e})).join(","),update_fields:A.filter((function(e){return!!e})).join(","),add_right:P?1:0,del_right:R?1:0}}).then((function(t){0===t.data.code?(f.a.success("\u4fdd\u5b58\u6210\u529f"),e.goBack()):f.a.error(t.data.msg)})).catch((function(e){f.a.error(e.message)})):f.a.error("\u8bf7\u586b\u5199\u89d2\u8272\u540d\u79f0\u548c\u89d2\u8272\u63cf\u8ff0")}},"\u4fdd\u5b58")}),r.a.createElement(h.a,{loading:Y||V,paragraph:{rows:10},active:!0},r.a.createElement(ae.a,{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:8}}},r.a.createElement(ae.a.Item,{required:!0,label:"\u89d2\u8272\u540d\u79f0"},r.a.createElement(g.a,{onChange:function(e){var t=e.target;return j(t.value)},value:E})),r.a.createElement(ae.a.Item,{required:!0,label:"\u89d2\u8272\u63cf\u8ff0"},r.a.createElement(g.a,{onChange:function(e){var t=e.target;return I(t.value)},value:w})),r.a.createElement(ae.a.Item,X,r.a.createElement(ne.a,{onChange:function(e){var t=e.target;return T(t.checked)},checked:P},r.a.createElement("span",null,"\u5141\u8bb8",r.a.createElement("b",{style:{color:"#000",padding:"0 5px"}},"\u6dfb\u52a0"),"\u6570\u636e"))),r.a.createElement(ae.a.Item,X,r.a.createElement(ne.a,{onChange:function(e){var t=e.target;return D(t.checked)},checked:R},r.a.createElement("span",null,"\u5141\u8bb8",r.a.createElement("b",{style:{color:"#000",padding:"0 5px"}},"\u5220\u9664"),"\u6570\u636e"))),r.a.createElement(ae.a.Item,{label:"\u5feb\u6377\u9009\u9879"},r.a.createElement(ne.a,{onChange:function(e){var t=e.target;return ie("get",t.checked)}},"\u52fe\u9009\u6240\u6709",r.a.createElement("b",{style:{color:"#000",padding:"0 5px"}},"\u67e5\u8be2"),"\u5b57\u6bb5"),r.a.createElement(ne.a,{onChange:function(e){var t=e.target;return ie("update",t.checked)}},"\u52fe\u9009\u6240\u6709",r.a.createElement("b",{style:{color:"#000",padding:"0 5px"}},"\u66f4\u65b0"),"\u5b57\u6bb5"))),r.a.createElement(C.a,{style:{width:"60%",marginLeft:"20%",marginTop:50},dataSource:le,pagination:!1},r.a.createElement(ce,{title:"\u5b57\u6bb5\u540d\u79f0",dataIndex:"key",key:"key",width:"20%"}),r.a.createElement(ce,{title:"\u5b57\u6bb5\u63cf\u8ff0",dataIndex:"desc",key:"desc"}),r.a.createElement(ce,{title:"\u6743\u9650\u914d\u7f6e",width:"180px",render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(ne.a,{checked:e.get,onChange:function(t){var a=t.target;return oe("get",e,a.checked)}},"\u67e5\u8be2"),r.a.createElement(ne.a,{checked:e.update,onChange:function(t){var a=t.target;return oe("update",e,a.checked)}},"\u66f4\u65b0"))}}))))};function oe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var ie=C.a.Column,ue=function(){var e=Object(i.g)(),t=k(Object(i.h)().search),a=t.id&&Number(t.id)||0,c=a>0?"\u7f16\u8f91 ".concat(t.name):"\u6dfb\u52a0\u805a\u5408\u89d2\u8272",l=Object(n.useState)(""),o=Object(m.a)(l,2),u=o[0],s=o[1],d=Object(n.useState)(""),p=Object(m.a)(d,2),b=p[0],j=p[1],y=Object(n.useState)([]),x=Object(m.a)(y,2),w=x[0],I=x[1],N=Object(n.useState)(""),_=Object(m.a)(N,2),P=_[0],T=_[1],q=Object(n.useState)([]),B=Object(m.a)(q,2),R=B[0],D=B[1],U=Object(n.useState)(!1),K=Object(m.a)(U,2),L=K[0],F=K[1],z=Object(n.useState)([]),M=Object(m.a)(z,2),A=M[0],J=M[1],$=Object(n.useState)([]),G=Object(m.a)($,2),Y=G[0],Z=G[1],H=Object(n.useState)(!1),Q=Object(m.a)(H,2),V=Q[0],X=Q[1],ee=Object(n.useState)(!1),te=Object(m.a)(ee,2),re=te[0],ce=te[1];Object(n.useEffect)((function(){var t=!1;return a||0===a||e.goBack(),Pe({url:"/v2/common/role",params:{id:a}}).then((function(e){if(!t&&0===e.data.code){var a=e.data.data;I(a.tables);var n=a.role||{};if(n.id){s(n.name),j(n.desc),console.log("setTable",n.table);var r=a.tables.find((function(e){return e.value===n.table}));T(r&&r.id),D(n.table_right_list.split(","))}}})).catch((function(e){f.a.error(e.message)})),function(){t=!0}}),[a]),Object(n.useEffect)((function(){console.log("tableSelected",P);F(R.length>0),R.length&&w.length&&A.length&&function(e){var t=w.find((function(e){return e.value===P})),a=t&&t.columns.map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?oe(a,!0).forEach((function(t){Object(v.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):oe(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e,{get:"",update:""})}))||[];ce(!1),ce(!1),e.forEach((function(e){var t=A.find((function(t){return Number(t.id)===Number(e)}));t.add_right&&X(!0),t.del_right&&ce(!0);var n=t.update_fields.split(",").filter((function(e){return!!e})),r=t.get_fields.split(",").filter((function(e){return!!e}));n.forEach((function(e){var t=a.findIndex((function(t){return t.key===e}));t>-1?a[t].update="Y":a.push({key:e,update:"Y",get:""})})),r.forEach((function(e){var t=a.findIndex((function(t){return t.key===e}));t>-1?a[t].get="Y":a.push({key:e,get:"Y",update:""})}))})),Z(a)}(R)}),[R,w,A,P]),Object(n.useEffect)((function(){P&&function(e){T(e),Z([]);w.find((function(t){return t.id===e}));Pe({url:"/v2/common/tableRight/list",params:{tableId:e,pageSize:1e5}}).then((function(e){if(0===e.data.code){var t=[];e.data.data.list.forEach((function(e){t.push(e)})),J(t)}}))}(P)}),[P]);var le={wrapperCol:{xs:{span:16,offset:0},sm:{span:8,offset:8}}};return r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{title:c,onBack:function(){e.goBack()},extra:r.a.createElement(O.a,{type:"primary",onClick:function(){if(u&&b)if(R.length){var t=w.find((function(e){return e.id===P}));Pe({method:"POST",url:"/v2/common/role/save",data:{id:a,name:u,desc:b,table:t&&t.value,table_right_list:R.join(",")}}).then((function(t){0===t.data.code?(f.a.success("\u4fdd\u5b58\u6210\u529f"),e.goBack()):f.a.error(t.data.msg)})).catch((function(e){f.a.error(e.message)}))}else f.a.error("\u8bf7\u9009\u62e9\u5305\u542b\u7684\u89d2\u8272");else f.a.error("\u8bf7\u586b\u5199\u805a\u5408\u89d2\u8272\u540d\u79f0\u548c\u805a\u5408\u89d2\u8272\u63cf\u8ff0")}},"\u4fdd\u5b58")}),r.a.createElement(h.a,{loading:!1,paragraph:{rows:10},active:!0},r.a.createElement(ae.a,{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:8}}},r.a.createElement(ae.a.Item,{required:!0,label:"\u805a\u5408\u89d2\u8272\u540d\u79f0"},r.a.createElement(g.a,{onChange:function(e){var t=e.target;return s(t.value)},value:u})),r.a.createElement(ae.a.Item,{required:!0,label:"\u805a\u5408\u89d2\u8272\u63cf\u8ff0"},r.a.createElement(g.a,{onChange:function(e){var t=e.target;return j(t.value)},value:b})),r.a.createElement(ae.a.Item,{required:!0,label:"\u805a\u5408\u89d2\u8272\u5173\u8054\u8868"},r.a.createElement(E.a,{disabled:L,showSearch:!0,onChange:T,value:P},w.map((function(e){return r.a.createElement(E.a.Option,{value:e.id,key:e.key},e.key)}))),P?r.a.createElement(O.a,{type:"link",onClick:function(){var t=w.find((function(e){return e.value===P}));e.push("/home/table-manage/single-table-right-list".concat(S({name:P,desc:t.key})))}},"\u70b9\u6211\u7f16\u8f91",function(e){var t=w.find((function(t){return t.value===e}));return t&&t.key}(P),"\u8868\u89d2\u8272"):null),r.a.createElement(ae.a.Item,{required:!0,label:"\u5305\u542b\u89d2\u8272"},r.a.createElement(E.a,{mode:"multiple",onChange:D,value:R},A.map((function(e){return r.a.createElement(E.a.Option,{key:e.id},e.name)})))),r.a.createElement(ae.a.Item,le,r.a.createElement(ne.a,{checked:V},"\u6dfb\u52a0\uff08add\uff09\u6743\u9650")),r.a.createElement(ae.a.Item,le,r.a.createElement(ne.a,{checked:re},"\u5220\u9664\uff08delete\uff09\u6743\u9650"))),r.a.createElement(C.a,{style:{width:"50%",marginLeft:"25%",marginTop:50},dataSource:Y,pagination:!1},r.a.createElement(ie,{title:"\u5b57\u6bb5\u540d\u79f0",dataIndex:"key",key:"key"}),r.a.createElement(ie,{title:"\u5b57\u6bb5\u63cf\u8ff0",dataIndex:"desc",key:"desc"}),r.a.createElement(ie,{title:"\u8bfb\u6743\u9650",dataIndex:"get",key:"get"}),r.a.createElement(ie,{title:"\u5199\u6743\u9650",dataIndex:"update",key:"update"}))))},me=a(382),se=a.n(me),de=(a(717),function(){var e=Object(i.g)(),t=k(Object(i.h)().search),a=t.id&&Number(t.id)||0,c=a>0?"\u7f16\u8f91 <".concat(t.name,"> \u81ea\u5b9a\u4e49\u903b\u8f91"):"\u6dfb\u52a0\u81ea\u5b9a\u4e49\u903b\u8f91",l=Object(n.useState)(""),o=Object(m.a)(l,2),u=o[0],s=o[1],d=Object(n.useState)(""),p=Object(m.a)(d,2),b=p[0],v=p[1],j=Object(n.useState)(""),y=Object(m.a)(j,2),S=y[0],x=y[1],w=Object(n.useState)(""),C=Object(m.a)(w,2),I=C[0],N=C[1],_=Object(n.useState)(!1),P=Object(m.a)(_,2),T=P[0],q=P[1];Object(n.useEffect)((function(){a&&(q(!0),Pe({url:"/v2/common/customMid/detail",params:{id:a}}).then((function(e){if(0===e.data.code){var t=e.data.data;s(t.name),v(t.desc),x(t.type),N(t.function)}})).catch((function(e){f.a.error(e.message)})).finally((function(){return q(!1)})))}),[a]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{title:c,onBack:function(){e.goBack()},extra:r.a.createElement(O.a,{type:"primary",onClick:function(){u&&S?Pe({url:"/v2/common/saveCustomMid",method:"POST",data:{id:a,name:u,desc:b,type:S,function:I}}).then((function(t){0===t.data.code?(f.a.success("\u4fdd\u5b58\u6210\u529f"),e.goBack()):f.a.error(t.data.msg)})).catch((function(e){f.a.error(e.message)})):f.a.error("\u8bf7\u586b\u5199\u81ea\u5b9a\u4e49\u903b\u8f91\u540d\u79f0\u548c\u7c7b\u578b")}},"\u4fdd\u5b58")}),r.a.createElement(h.a,{loading:T,paragraph:{rows:10},active:!0},r.a.createElement(ae.a,{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:8}}},r.a.createElement(ae.a.Item,{required:!0,label:"\u81ea\u5b9a\u4e49\u903b\u8f91\u540d\u79f0"},r.a.createElement(g.a,{onChange:function(e){var t=e.target;return s(t.value)},value:u})),r.a.createElement(ae.a.Item,{required:!0,label:"\u63cf\u8ff0"},r.a.createElement(g.a,{onChange:function(e){var t=e.target;return v(t.value)},value:b})),r.a.createElement(ae.a.Item,{required:!0,label:"\u81ea\u5b9a\u4e49\u903b\u8f91\u7c7b\u578b"},r.a.createElement(E.a,{value:S,onChange:x},r.a.createElement(E.a.Option,{value:"req"},"Request\u4e2d\u95f4\u4ef6"))),r.a.createElement("div",{className:"monaco-editor-wrap"},r.a.createElement("div",{className:"monaco-editor-container"},r.a.createElement(se.a,{language:"javascript",value:I,options:{selectOnLineNumbers:!0,renderSideBySide:!1},onChange:N,editorDidMount:function(e,t){console.log("editorDidMount",e),e.focus()}}))))))}),pe=E.a.Option,fe=function(){var e=0,t=Object(i.g)(),a=k(Object(i.h)().search),c=a.id&&Number(a.id)||0,l=c>0?"\u7f16\u8f91 ".concat(a.name," \u5e94\u7528"):"\u6dfb\u52a0\u5e94\u7528",o=Object(n.useState)(""),u=Object(m.a)(o,2),s=u[0],d=u[1],b=Object(n.useState)(""),v=Object(m.a)(b,2),j=v[0],y=v[1],S=Object(n.useState)([]),x=Object(m.a)(S,2),w=x[0],C=x[1],_=Object(n.useState)([]),P=Object(m.a)(_,2),T=P[0],q=P[1],B=Object(n.useState)([]),R=Object(m.a)(B,2),D=R[0],U=R[1],K=Object(n.useState)([]),L=Object(m.a)(K,2),F=(L[0],L[1]),z=Object(n.useState)([]),M=Object(m.a)(z,2),A=M[0],J=M[1],$=Object(n.useState)([]),G=Object(m.a)($,2),Y=G[0],Z=G[1],H=Object(n.useState)(!1),Q=Object(m.a)(H,2),V=Q[0],X=Q[1];Object(n.useEffect)((function(){c||0===c?(X(!0),Pe({url:"/v2/common/app/detail",params:{id:c}}).then((function(e){if(0===e.data.code){var t=e.data.data,a=t.detail||{name:"",app_code:"",app_roles:"",req_middleware_list:"",res_middleware_list:"",default_page_size:"10"};d(a.name),y(a.app_code),U(t.reqOptList),F(t.resOptList),Z(t.rolesList),J(a.app_roles.split(",").filter(Boolean));var n=[];a.req_middleware_list.split(",").filter(Boolean).forEach((function(e){var a=t.reqOptList.find((function(t){return Number(t.id)===Number(e)}));a&&n.push(a)})),C(n);var r=[];a.res_middleware_list.split(",").filter(Boolean).forEach((function(e){var a=t.resOptList.find((function(t){return Number(t.id)===Number(e)}));a&&r.push(a)})),q(r)}})).catch((function(e){f.a.error(e.message)})).finally((function(){return X(!1)}))):t.goBack()}),[c]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{title:l,onBack:function(){t.goBack()},extra:r.a.createElement(O.a,{type:"primary",onClick:function(){console.log(s,j,w,T,A),s&&j?Pe({url:"/v2/common/app/save",method:"POST",data:{id:c,name:s,app_code:j,req_middleware_list:w.map((function(e){return e.id})).filter(Boolean).join(","),res_middleware_list:T.map((function(e){return e.id})).filter(Boolean).join(","),app_roles:A.filter(Boolean).join(",")}}).then((function(e){0===e.data.code?(f.a.success("\u4fdd\u5b58\u6210\u529f"),t.goBack()):f.a.error(e.data.msg)})).catch((function(e){f.a.error(e.message)})):f.a.error("\u8bf7\u586b\u5199\u5e94\u7528\u540d\u79f0\u548c\u5e94\u7528Code")}},"\u4fdd\u5b58")}),r.a.createElement(h.a,{loading:V,paragraph:{rows:10},active:!0},r.a.createElement(ae.a,{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:8}}},r.a.createElement(ae.a.Item,{required:!0,label:"\u5e94\u7528\u540d\u79f0"},r.a.createElement(g.a,{onChange:function(e){var t=e.target;return d(t.value)},value:s})),r.a.createElement(ae.a.Item,{required:!0,label:"\u5e94\u7528Code"},r.a.createElement(g.a,{onChange:function(e){var t=e.target;return y(t.value)},value:j})),r.a.createElement(ae.a.Item,{label:"Request\u4e2d\u95f4\u4ef6"},r.a.createElement(E.a,{showSearch:!0,placeholder:"\u6dfb\u52a0Request\u4e2d\u95f4\u4ef6",optionFilterProp:"children",onSelect:function(e){var t=D.find((function(t){return t.id===e}));C([].concat(Object(te.a)(w),[t]))},allowClear:!0,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},D.map((function(t){return r.a.createElement(pe,{key:e++,value:t.id},t.name)}))),w.map((function(t,a){return r.a.createElement("span",{key:e++},r.a.createElement(I.a,{title:t.desc},r.a.createElement(N.a,{key:e++},t.name)),w.length-1!==a&&r.a.createElement(p.a,{type:"arrow-right",style:{paddingRight:10}}))})),w.length?r.a.createElement(O.a,{type:"link",onClick:function(){C([])}},"\u6e05\u7a7a"):null),r.a.createElement(ae.a.Item,{label:"\u89d2\u8272"},r.a.createElement(E.a,{mode:"multiple",defaultValue:A,onChange:J},Y.map((function(e){return r.a.createElement(pe,{key:e.id},e.name)})))))))},be=(a(718),C.a.Column),ge=g.a.Search,Ee=function(){var e=Number(sessionStorage.getItem("db-manage-page")||"1"),t=Object(n.useState)(""),a=Object(m.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(e),i=Object(m.a)(o,2),u=i[0],s=i[1],d=Object(n.useState)(10),p=Object(m.a)(d,2),b=p[0],h=p[1],v=Object(n.useState)(!1),j=Object(m.a)(v,2),k=j[0],S=j[1],x=Object(n.useState)(1),w=Object(m.a)(x,2),I=w[0],_=w[1],P=Object(n.useState)(0),T=Object(m.a)(P,2),q=T[0],B=T[1],K=Object(n.useState)(""),L=Object(m.a)(K,2),F=L[0],z=L[1],M=Object(n.useState)(""),A=Object(m.a)(M,2),J=A[0],$=A[1],G=Object(n.useState)(""),Y=Object(m.a)(G,2),Z=Y[0],H=Y[1],W=Object(n.useState)(""),Q=Object(m.a)(W,2),V=Q[0],X=Q[1],ee=Object(n.useState)(""),te=Object(m.a)(ee,2),ne=te[0],re=te[1],ce=Object(n.useState)(""),le=Object(m.a)(ce,2),oe=le[0],ie=le[1],ue=Object(n.useState)(""),me=Object(m.a)(ue,2),se=me[0],de=me[1],pe=Object(n.useState)(!1),fe=Object(m.a)(pe,2),Ee=fe[0],he=fe[1],Oe=Object(n.useState)(0),ve=Object(m.a)(Oe,2),je=ve[0],ye=ve[1],ke=Object(n.useState)(""),Se=Object(m.a)(ke,2),xe=Se[0],we=Se[1],Ce=Object(n.useState)([]),Ie=Object(m.a)(Ce,2),Ne=Ie[0],_e=Ie[1],Te=Object(n.useState)([]),qe=Object(m.a)(Te,2),Be=qe[0],Re=qe[1],De=Object(n.useState)([]),Ue=Object(m.a)(De,2),Ke=Ue[0],Le=Ue[1],Fe=Object(n.useState)(""),ze=Object(m.a)(Fe,2),Me=ze[0],Ae=ze[1],Je=Object(n.useState)(""),$e=Object(m.a)(Je,2),Ge=$e[0],Ye=$e[1],Ze=Object(n.useState)(""),He=Object(m.a)(Ze,2),We=He[0],Qe=He[1],Ve=Object(n.useState)(""),Xe=Object(m.a)(Ve,2),et=Xe[0],tt=Xe[1],at=y(Object(n.useMemo)((function(){return{url:"/v2/common/db/list",params:{search:c,page:c?1:u,pageSize:10}}}),[u,c,I])),nt=at.data,rt=at.loading;Object(n.useEffect)((function(){h(nt.totalCount)}),[nt]);var ct={showTotal:function(){return"\u5171".concat(b,"\u6761")},pageSize:10,current:u,total:b,onChange:function(e){s(e),sessionStorage.setItem("db-manage-page",String(e))}},lt=function(){var e=Object(D.a)(R.a.mark((function e(t,a){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pe({url:"/v2/common/tryDb",method:"GET",params:{id:t}});case 2:0===e.sent.data.code?(f.a.success("\u6570\u636e\u5e93 ".concat(a," \u8fde\u63a5\u6d4b\u8bd5\u901a\u8fc7")),_(I+1)):f.a.error("\u8fde\u63a5\u6d4b\u8bd5\u5931\u8d25\uff0c\u8bf7\u67e5\u770b\u914d\u7f6e");case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ot=function(){var e=Object(D.a)(R.a.mark((function e(){var t;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B(0),!(F&&Z&&V&&se&&ne&&oe)){e.next=11;break}return/^[a-zA-Z0-9\.]+$/,/^[0-9]+$/,/^[a-zA-Z-_]+$/,e.next=7,Pe({url:"/v2/common/db/save",method:"POST",data:{id:q,key:J,name:F,config:"".concat(Z,">>>").concat(V,">>>").concat(se,">>>").concat(ne,">>>").concat(oe),valid:0}});case 7:0===(t=e.sent).data.code?(z(""),H(""),X(""),de(""),re(""),ie(""),f.a.success("\u4fdd\u5b58\u6210\u529f"),_(I+1),S(!1)):(f.a.error(t.data.msg),S(!1)),e.next=12;break;case 11:f.a.error("\u8bf7\u586b\u5199\u5b8c\u6574\u5728\u63d0\u4ea4");case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),it={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:12}}},ut=function(){var e=Object(D.a)(R.a.mark((function e(){var t;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pe({url:"/v2/common/refreshDb",method:"POST"});case 2:0===(t=e.sent).data.code?f.a.success("\u6570\u636e\u5e93\u914d\u7f6e\u5199\u5165\u6210\u529f"):f.a.error(t.data.msg);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),mt=function(){var e=Object(D.a)(R.a.mark((function e(t,a){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:U.a.confirm({title:"\u786e\u8ba4\u5220\u9664\uff1f",content:"\u5220\u9664".concat(a),okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){var e=Object(D.a)(R.a.mark((function e(){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pe({url:"/v2/common/db/del",method:"POST",data:{id:t}});case 2:0===e.sent.data.code&&(f.a.success("\u5220\u9664\u6210\u529f"),_(I+1));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),onCancel:function(){}});case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),st=function(){var e=Object(D.a)(R.a.mark((function e(t,a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pe({url:"/v2/common/fetch/db/tables",method:"POST",data:{id:t}});case 2:0===(n=e.sent).data.code&&(console.log(n.data),_e(n.data.data.tableList),Re(n.data.data.importedTables.map((function(e){return e.table_name}))),he(!0),ye(t),Le([]),tt(""),Ae(""),Ye(""),Qe(""),he(!0));case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),dt=function(){var e=Object(D.a)(R.a.mark((function e(){var t,a,n,r,c;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ke.length){e.next=3;break}return f.a.error("\u8bf7\u9009\u62e9\u6b63\u786e\u7684Table"),e.abrupt("return");case 3:if(Me){e.next=6;break}return f.a.error("\u8bf7\u586b\u5199\u8868\u7684\u63cf\u8ff0"),e.abrupt("return");case 6:if(et){e.next=9;break}return f.a.error("\u8bf7\u586b\u5199\u5168\u5c40\u552f\u4e00\u8868\u540d"),e.abrupt("return");case 9:if(We){e.next=12;break}return f.a.error("\u8bf7\u586b\u5199uniqueKey"),e.abrupt("return");case 12:if(t=Ke.map((function(e){return e.Field})),!Ge||-1!==t.indexOf(Ge)){e.next=16;break}return f.a.error("\u4e0d\u5408\u6cd5\u7684UUID"),e.abrupt("return");case 16:if(!We||-1!==t.indexOf(We)){e.next=19;break}return f.a.error("\u4e0d\u5408\u6cd5\u7684uniqueKey"),e.abrupt("return");case 19:return a=nt.list,n=a.find((function(e){return e.id===je})),r=Ke.find((function(e){return"PRI"===e.Key})),e.next=24,Pe({url:"/v2/common/table/save",method:"POST",data:{filename:et,db:n&&n.key,db_real:n&&n.config.split(">>>")[2],name:Me,table_name:xe,uuid:Ge,unique_key:We,primary_key:r&&r.Field,columns:Ke.map((function(e){return{desc:e.Comment,key:e.Field,type:e.Type,isPrimary:"PRI"===e.Key}}))}});case 24:0===(c=e.sent).data.code?(he(!1),ye(0),Le([]),Ae(""),tt(""),Ye(""),Qe(""),f.a.success(c.data.msg)):f.a.error(c.data.msg);case 26:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pt=function(){var e=Object(D.a)(R.a.mark((function e(t){var a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(we(t),!(Be.indexOf(t)>-1)){e.next=7;break}return U.a.confirm({title:"\u8be5\u8868\u5df2\u88ab\u5bfc\u5165\u8fc7\uff0c\u662f\u5426\u4ece\u6570\u636e\u5e93\u66f4\u65b0\u5b57\u6bb5?",okText:"\u66f4\u65b0",cancelText:"\u53d6\u6d88",onOk:function(){var e=Object(D.a)(R.a.mark((function e(){var a,n,r,c;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=nt.list,n=a.find((function(e){return e.id===je})),e.next=4,Pe({url:"/v2/common/getTableByTableName",method:"GET",params:{table_name:t,db:n.key}});case 4:if(0===(r=e.sent).data.code){e.next=8;break}return f.a.error("\u83b7\u53d6\u8868\u4fe1\u606f\u5931\u8d25"),e.abrupt("return");case 8:return e.next=10,Pe({url:"/v2/common/fetch/table/columns",method:"POST",data:{id:je,table:t,updateId:r.data.data.id}});case 10:0===(c=e.sent).data.code?(f.a.success("\u66f4\u65b0\u6210\u529f"),he(!1),ye(0),Le([]),Ae(""),Ye(""),tt(""),Qe(""),_(I+1)):f.a.error(c.data.msg);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),onCancel:function(){he(!1)}}),e.abrupt("return");case 7:return e.next=9,Pe({url:"/v2/common/fetch/table/columns",method:"POST",data:{id:je,table:t}});case 9:0===(a=e.sent).data.code?Le(a.data.data):f.a.error(a.data.msg);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(ge,{placeholder:"\u641c\u7d22\u6570\u636e\u5e93",onSearch:function(e){return l(e)},style:{width:200,marginBottom:30}}),r.a.createElement(O.a,{type:"primary",style:{float:"right"},onClick:function(){S(!0)}},"\u6dfb\u52a0\u6570\u636e\u5e93"),r.a.createElement(O.a,{type:"ghost",style:{float:"right",marginRight:15},onClick:ut},"\u5199\u5165\u914d\u7f6e"),r.a.createElement(C.a,{dataSource:nt.list,loading:rt,rowKey:"id",pagination:ct},r.a.createElement(be,{title:"\u6570\u636e\u5e93\u540d\u79f0",dataIndex:"name",key:"name"}),r.a.createElement(be,{title:"\u6570\u636e\u5e93\u7d22\u5f15Key",dataIndex:"key",key:"key"}),r.a.createElement(be,{title:"\u6570\u636e\u5e93\u72b6\u6001",key:"valid",render:function(e){return r.a.createElement("span",{key:e.id},r.a.createElement(N.a,{key:"pass",color:1===e.valid?"green":"red"},1===e.valid?"\u901a\u8fc7":"\u672a\u901a\u8fc7"))}}),r.a.createElement(be,{title:"\u64cd\u4f5c",key:"action",render:function(e){return r.a.createElement("span",{key:e.id},r.a.createElement(O.a,{type:"link",onClick:function(){return st(e.id,e.name)}},"\u6dfb\u52a0\u8868"),r.a.createElement(O.a,{type:"link",onClick:function(){return lt(e.id,e.name)}},"\u8fde\u63a5\u6d4b\u8bd5"),r.a.createElement(O.a,{type:"link",onClick:function(){return function(e){S(!0),B(e.id),$(e.key),z(e.name);var t=e.config.split(">>>");H(t[0]),X(t[1]),de(t[2]),re(t[3]),ie(t[4])}(e)}},"\u7f16\u8f91"),r.a.createElement(O.a,{type:"link",style:{color:"red"},onClick:function(){return mt(e.id,e.name)}},"\u5220\u9664"))}})),r.a.createElement(U.a,{width:800,title:"\u5f55\u5165\u6570\u636e\u5e93",visible:k,onOk:ot,onCancel:function(){S(!1)},okText:"\u4fdd\u5b58",cancelText:"\u53d6\u6d88"},r.a.createElement(ae.a,it,r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(ae.a.Item,{required:!0,label:"\u6570\u636e\u5e93\u6635\u79f0"},r.a.createElement(g.a,{onChange:function(e){var t=e.target;return z(t.value)},value:F})),r.a.createElement(ae.a.Item,{required:!0,label:"host"},r.a.createElement(g.a,{onChange:function(e){var t=e.target;return H(t.value)},value:Z})),r.a.createElement(ae.a.Item,{required:!0,label:"port"},r.a.createElement(g.a,{onChange:function(e){var t=e.target;return X(t.value)},value:V})),r.a.createElement(ae.a.Item,{required:!0,label:"db(\u771f\u5b9e\u540d\u79f0)"},r.a.createElement(g.a,{onChange:function(e){var t=e.target;return de(t.value)},value:se})),r.a.createElement(ae.a.Item,{required:!0,label:"key(\u6620\u5c04\u540d\u79f0)"},r.a.createElement(g.a,{onChange:function(e){var t=e.target;return $(t.value)},value:J})),r.a.createElement(ae.a.Item,{required:!0,label:"user"},r.a.createElement(g.a,{onChange:function(e){var t=e.target;return re(t.value)},value:ne})),r.a.createElement(ae.a.Item,{required:!0,label:"password"},r.a.createElement(g.a,{onChange:function(e){var t=e.target;return ie(t.value)},value:oe})))))),r.a.createElement(U.a,{className:"modal-add-table",width:800,title:"\u6dfb\u52a0\u8868",visible:Ee,onOk:dt,onCancel:function(){he(!1)},okText:"\u4fdd\u5b58",cancelText:"\u53d6\u6d88"},r.a.createElement(ae.a,it,Ee&&r.a.createElement(ae.a.Item,{required:!0,label:"\u8868\u540d"},r.a.createElement(E.a,{showSearch:!0,style:{width:376},onChange:pt,placeholder:"\u9009\u62e9\u8868\u540d, \u53ef\u641c\u7d22",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},Ne&&Ne.length&&Ne.map((function(e){return r.a.createElement(E.a.Option,{value:e,key:e},e)})))),Ke.length?r.a.createElement(r.a.Fragment,null,r.a.createElement(ae.a.Item,{required:!0,label:"\u8868\u63cf\u8ff0"},r.a.createElement(g.a,{placeholder:"\u8bf7\u7ed9\u8fd9\u5f20\u8868\u6dfb\u52a0\u4e00\u70b9\u63cf\u8ff0",onChange:function(e){var t=e.target;return Ae(t.value)},value:Me})),r.a.createElement(ae.a.Item,{required:!0,label:"\u5168\u5c40\u552f\u4e00\u8868\u540d"},r.a.createElement(g.a,{placeholder:"\u7528\u4e8e\u8c03\u7528\u8be5\u8868(\u8bf7\u4f7f\u7528\u9a7c\u5cf0\u4e66\u5199)",onChange:function(e){var t=e.target;return tt(t.value)},value:et})),r.a.createElement(ae.a.Item,{label:"UUID"},r.a.createElement(g.a,{placeholder:"\u5982\u679c\u9700\u8981,\u8bf7\u914d\u7f6eUUID",onChange:function(e){var t=e.target;return Ye(t.value)},value:Ge})),r.a.createElement(ae.a.Item,{required:!0,label:"UniqueKey"},r.a.createElement(g.a,{placeholder:"\u8bf7\u914d\u7f6eUniqueKey(\u4e00\u822c\u4e3aPrimaryKey)",onChange:function(e){var t=e.target;return Qe(t.value)},value:We}))):null),r.a.createElement("div",{className:"field-wrapper"},Ke&&Ke.map((function(e){return r.a.createElement("div",{key:e.Field,className:"field-block"},r.a.createElement("span",{className:"field-item"},e.Field,"PRI"===e.Key?"(\u4e3b\u952e)":""),r.a.createElement("span",{className:"field-item"},e.Type),r.a.createElement("span",{className:"field-item desc"},e.Comment))})))))},he=s.a.Header,Oe=s.a.Sider,ve=s.a.Content,je=d.a.SubMenu,ye=function(){var e=Object(i.g)(),t=Object(n.useState)(!1),a=Object(m.a)(t,2),c=a[0],l=a[1];return r.a.createElement(s.a,{className:"home"},r.a.createElement(Oe,{trigger:null,collapsible:!0,collapsed:c},r.a.createElement(u.b,{to:"/home"},r.a.createElement("div",{className:"logo"},!c&&"APIJSON")),r.a.createElement(d.a,{theme:"dark",mode:"inline",defaultSelectedKeys:["1"]},r.a.createElement(d.a.Item,{key:"doc"},r.a.createElement(p.a,{type:"file-text"}),r.a.createElement("span",null,"\u6587\u6863"),r.a.createElement(u.b,{to:"/doc"})),r.a.createElement(d.a.Item,{key:"body-generator"},r.a.createElement(p.a,{type:"appstore"}),r.a.createElement("span",null,"\u5e94\u7528\u7ba1\u7406"),r.a.createElement(u.b,{to:"/home/app-manage"})),r.a.createElement(je,{key:"right-manage",title:r.a.createElement("span",null,r.a.createElement(p.a,{type:"usergroup-add"}),r.a.createElement("span",null,"\u6743\u9650\u7ba1\u7406"))},r.a.createElement(d.a.Item,{key:"db"},r.a.createElement(p.a,{type:"database"}),r.a.createElement("span",null,"\u6570\u636e\u5e93\u7ba1\u7406"),r.a.createElement(u.b,{to:"/home/db-manage"})),r.a.createElement(d.a.Item,{key:"table"},r.a.createElement(p.a,{type:"table"}),r.a.createElement("span",null,"\u8868\u7ba1\u7406"),r.a.createElement(u.b,{to:"/home/table-manage"})),r.a.createElement(d.a.Item,{key:"role"},r.a.createElement(p.a,{type:"user-add"}),r.a.createElement("span",null,"\u89d2\u8272\u7ba1\u7406"),r.a.createElement(u.b,{to:"/home/role-manage"}))),r.a.createElement(d.a.Item,{key:"2"},r.a.createElement(p.a,{type:"video-camera"}),r.a.createElement("span",null,"\u81ea\u5b9a\u4e49\u903b\u8f91\u7ba1\u7406"),r.a.createElement(u.b,{to:"/home/logic-manage"})))),r.a.createElement(s.a,null,r.a.createElement(he,{style:{background:"#fff",padding:0}},r.a.createElement(p.a,{className:"trigger",type:c?"menu-unfold":"menu-fold",onClick:function(){return l(!c)}}),r.a.createElement("div",{className:"logout-btn",onClick:function(){Pe({url:"/common/logout"}).then((function(t){0===t.data.code&&(Se.isLogin=!1,e.push("/"))}))}},"\u9000\u51fa\u767b\u5f55"),r.a.createElement("div",{className:"header-userinfo"},Se.isLogin?Se.loginInfo.realName:"")),r.a.createElement(ve,{style:{margin:"24px 16px",padding:24,background:"#fff",minHeight:280,overflowY:"auto"}},r.a.createElement(i.d,null,r.a.createElement(i.b,{exact:!0,path:"/doc",component:w}),r.a.createElement(i.b,{exact:!0,path:"/body-gen",component:x}),r.a.createElement(i.b,{exact:!0,path:"/home",component:H}),r.a.createElement(i.b,{exact:!0,path:"/home/app-manage",component:q}),r.a.createElement(i.b,{exact:!0,path:"/home/add-or-edit-app",component:fe}),r.a.createElement(i.b,{exact:!0,path:"/home/db-manage",component:Ee}),r.a.createElement(i.b,{exact:!0,path:"/home/role-manage",component:A}),r.a.createElement(i.b,{exact:!0,path:"/home/role-detail",component:ue}),r.a.createElement(i.b,{exact:!0,path:"/home/table-manage",component:F}),r.a.createElement(i.b,{exact:!0,path:"/home/table-manage/single-table-right-list",component:ee}),r.a.createElement(i.b,{exact:!0,path:"/home/table-manage/add-or-edit-table-right",component:le}),r.a.createElement(i.b,{exact:!0,path:"/home/logic-manage",component:G}),r.a.createElement(i.b,{exact:!0,path:"/home/add-or-edit-mid",component:de})))))},ke=(a(719),function(){var e=Object(i.g)(),t=Object(i.h)(),a=Object(n.useState)(""),c=Object(m.a)(a,2),l=c[0],o=c[1],u=Object(n.useState)(""),s=Object(m.a)(u,2),d=s[0],b=s[1];Object(n.useEffect)((function(){Pe({url:"/common/isLogin"}).then((function(a){0===a.data.code&&(Se.isLogin=!0,Se.loginInfo=a.data.data,e.push(t.state&&t.state.from||"/home"))}))}),[e,t]);var E=function(){Pe({url:"/common/login",method:"POST",data:{username:l,password:d}}).then((function(t){0===t.data.code?(Se.isLogin=!0,Se.loginInfo=t.data.data,f.a.success(t.data.msg),e.push("/home")):(Se.isLogin=!1,f.a.error(t.data.msg))}))};return r.a.createElement("div",{className:"login-box"},r.a.createElement("h1",null,"APIJSON \u7ba1\u7406\u5e73\u53f0"),r.a.createElement(g.a,{placeholder:"\u7528\u6237\u540d",className:"login-input",prefix:r.a.createElement(p.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),value:l,onChange:function(e){var t=e.target.value;return o(t)}}),r.a.createElement(g.a,{placeholder:"\u5bc6\u7801",className:"login-input",prefix:r.a.createElement(p.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",value:d,onChange:function(e){var t=e.target.value;return b(t)},onPressEnter:E}),r.a.createElement(O.a,{type:"primary",className:"login-btn",onClick:E},"\u767b\u5f55"))}),Se={isLogin:!1,loginInfo:{}};function xe(e){var t=e.children,a=Object(o.a)(e,["children"]);return r.a.createElement(i.b,Object.assign({},a,{render:function(e){var a=e.location;return Se.isLogin?t:r.a.createElement(i.a,{to:{pathname:"/login",state:{from:a.pathname}}})}}))}var we=function(){return r.a.createElement(u.a,null,r.a.createElement(i.d,null,r.a.createElement(i.b,{exact:!0,path:"/login",component:ke}),r.a.createElement(i.b,{exact:!0,path:"/",render:function(){return r.a.createElement(i.a,{to:{pathname:"/home"}})}}),r.a.createElement(xe,{path:"/"},r.a.createElement(ye,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ce=a(326),Ie=a.n(Ce);a.d(t,"CancelToken",(function(){return Ne})),a.d(t,"RequestStore",(function(){return _e})),a.d(t,"request",(function(){return Pe}));var Ne=Ie.a.CancelToken,_e={source:Ne.source()},Pe=Ie.a.create();Pe.interceptors.response.use((function(e){return 403===e.data.code&&"/common/isLogin"!==e.config.url&&(f.a.error("\u672a\u767b\u5f55\u6216\u767b\u5f55\u5df2\u8fc7\u671f"),setTimeout((function(){window.location.reload()}),500)),e}),(function(e){console.log(e)})),l.a.render(r.a.createElement(we,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[388,2,3]]]);
//# sourceMappingURL=main.38d1411b.chunk.js.map